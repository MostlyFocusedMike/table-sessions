(function(){"use strict";var timesTable={includedNum:[],usedNum:[],startRound:1,x:1,y:1,xEl:document.getElementById("x-id"),yEl:document.getElementById("y-id"),qNum:0,qRank:1,qOrder:[],pairs:{},correct:0,totalPoints:0,sessionMode:"sequence",endMsg:document.getElementById("end-msg"),cctMsg:document.getElementById('cct-msg'),wngMsg:document.getElementById('wng-msg'),wlcMsg:document.getElementById('welcome-msg'),roundBar:document.getElementById("round-mover"),sessionBar:document.getElementById("session-mover"),missedQs:document.getElementById("mis-qs"),setupRound:function(){var radios=document.getElementsByName("start-round"),checks=document.getElementsByName("include-num"),i;this.includedNum.length=0;for(i=0;i<12;i++){if(radios[i].checked){this.startRound=Number(radios[i].value)}
if(checks[i].checked){this.includedNum.push(Number(radios[i].value))}}
this.totalPoints=Math.pow((this.includedNum.length),2);this.showScore()},reset:function(){this.usedNum.length=0;this.correct=0;this.qNum=0;this.qRank=1;this.qOrder=[];this.pairs={};this.wlcMsg.style.display="block";this.cctMsg.style.display="none";this.wngMsg.style.display="none";this.endMsg.style.display="none";this.roundBar.style.left="0";this.sessionBar.style.left="0";this.missedQs.innerHTML=""},initialSetup:function(){this.reset();this.setupRound();this.setupField();if(this.sessionMode==="sequence"){this.xEl.textContent=this.startRound;this.yEl.textContent=this.includedNum[0];this.x=this.startRound;this.y=this.includedNum[0]}else{this.randomXY();this.nextRandomQ()}},checkAnswer:function(){var userAnsEl=document.getElementById("u-ans"),userAns=Number(userAnsEl.value),ans=this.x*this.y;if(this.endMsg.style.display==="block"){userAnsEl.value="";return}
if(Number.isNaN(userAns)||userAnsEl.value===""){window.alert("Only numbers in the answer form please");userAnsEl.value="";return}
if(userAns===ans){this.correct+=1;this.cctMsg.style.display="block";this.wngMsg.style.display="none";this.wlcMsg.style.display="none"}else{this.missedQs.innerHTML+="<p>"+this.x+" * "+this.y+" = "+(this.x*this.y)+", not "+userAns+"</p>";this.cctMsg.style.display="none";this.wngMsg.style.display="block";this.wlcMsg.style.display="none";document.getElementById('real-ans').textContent=ans}
this.qNum+=1;this.setupNextQ();this.adjustBars();this.showScore();userAnsEl.value=""},setupNextQ:function(){if(this.sessionMode==="sequence"){this.usedNum.push(this.y);if((this.usedNum.length<this.includedNum.length)){this.randomY()}else{this.nextRound()}}else{if(this.qNum<this.totalPoints){this.nextRandomQ()}else{this.end()}}},randomY:function(){while(!0){this.y=Math.floor((Math.random()*12)+1);if((this.includedNum.includes(this.y))&&(this.usedNum.includes(this.y)===!1)){this.yEl.textContent=this.y;break}}},nextRound:function(){this.x+=1;while(!(this.includedNum.includes(this.x))){if(this.x===13){break}
this.x+=1}
if(this.x===13){this.end();return}
this.xEl.textContent=this.x;this.adjustScore();this.adjustBars();this.usedNum.length=0;this.randomY();this.showScore();this.adjustBars()},adjustScore:function(){if(this.sessionMode==="sequence"){if((this.usedNum.length!==this.includedNum.length)&&(this.endMsg.style.display==="none")){var scoreAdjuster=this.includedNum.length-this.usedNum.length;this.totalPoints-=scoreAdjuster}}else{this.totalPoints=this.qNum}},end:function(){this.showScore();this.totalPoints=this.qNum;this.adjustBars();document.getElementById("end-msg").style.display="block";document.getElementById("tot-q").textContent=this.correct+"/"+this.qNum;if(this.missedQs.innerHTML===""){if(this.totalPoints>9){this.missedQs.innerHTML="<p>You made no mistakes,<br />great job!</p>"}else if(this.totalPoints<=9&&this.totalPoints>0){this.missedQs.innerHTML="<p>You skipped a lot,<br />but made no mistakes."}else{this.missedQs.innerHTML="<p>You didn't actually<br />do the session..."}}
this.x=12;return},showScore:function(){var scoreEl=document.getElementsByClassName("fin-score"),score=(this.correct/this.qNum)*100,color,i;score=score.toFixed(0);if(isNaN(score)){score=0}
if(score===100){color="#29ACFD"}else if(score>=95){color="#004EFF"}else if(score>=80){color="#28A219"}else if(score>=60){color="#EBB500"}else if(score>=40){color="#A21919"}else{color="#333"}
for(i=0;i<scoreEl.length;i++){scoreEl[i].textContent=score+"%";scoreEl[i].style.color=color}},adjustBars:function(){var sesPosVal=(this.qNum/this.totalPoints*100),rouPosVal=(this.usedNum.length/this.includedNum.length*100);this.sessionBar.style.left=sesPosVal+"%";this.roundBar.style.left=rouPosVal+"%"},randomXY:function(){var incLength=this.includedNum.length,i,k;for(i=0;i<incLength;i++){for(k=0;k<incLength;k++){this.pairs[this.qRank]=[this.includedNum[i],this.includedNum[k]];this.qOrder.push(this.qRank);this.qRank+=1}}
this.qOrder.sort(function(a,b){return 0.5-Math.random()})},nextRandomQ:function(){this.x=this.pairs[this.qOrder[this.qNum]][0];this.y=this.pairs[this.qOrder[this.qNum]][1];this.xEl.textContent=this.x;this.yEl.textContent=this.y},setMode:function(e){var setting=event.target.id;this.sessionMode=setting;if(setting==="random"){document.getElementById("session-type").textContent="Randomly"}else{document.getElementById("session-type").textContent="In Order"}},setupField:function(){var seqEl=document.getElementsByClassName("seq-el"),randEl=document.getElementById("end-button"),seqElLength=seqEl.length,i;if(this.sessionMode==="sequence"){for(i=0;i<seqElLength;i++){seqEl[i].style.display="block"}
randEl.style.display="none";window.scrollBy(0,400)}else{for(i=0;i<seqElLength;i++){seqEl[i].style.display="none"}
randEl.style.display="block"}}};function toggleBoxes(){var boxes=[document.getElementById("create-box"),document.getElementById("cnf-holder")],i;boxes[0].style.display=boxes[0].style.display==='none'?'block':'none';boxes[1].style.display=boxes[1].style.display==='block'?'none':'block'}(function(){timesTable.initialSetup()}());var start=document.getElementById("start-button"),skip=document.getElementById("skip-button"),uInput=document.getElementById("u-ans");document.getElementById("create-button").addEventListener("click",function(){toggleBoxes();window.scrollBy(0,400)});document.getElementById("close-button").addEventListener("click",function(){toggleBoxes()});document.getElementById("start-button").addEventListener("click",function(){timesTable.initialSetup();uInput.value="";toggleBoxes()});skip.addEventListener("click",function(){timesTable.nextRound();uInput.focus()});uInput.addEventListener("focus",function(){uInput.value=""});uInput.addEventListener('keypress',function(e){var key=e.which||e.keyCode;if(key===13){timesTable.checkAnswer()}});document.getElementById("end-button").addEventListener("click",function(){timesTable.end()});document.getElementById("hide-end").addEventListener("click",function(){document.getElementById("end-msg").style.display="none";timesTable.initialSetup()});document.getElementById("random").addEventListener("click",function(){timesTable.setMode();timesTable.initialSetup()});document.getElementById("sequence").addEventListener("click",function(){timesTable.setMode();timesTable.initialSetup()})}())